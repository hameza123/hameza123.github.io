<!DOCTYPE html>
<html lang="en">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <title>
  Day 18: SOC Analyst Challenge  Â· SecLice
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="SecLice">
<meta name="description" content="SOC Analyst Challenge, Day 18 ">
<meta name="keywords" content="blog,Cybersecurity">



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Day 18: SOC Analyst Challenge ">
  <meta name="twitter:description" content="SOC Analyst Challenge, Day 18">

<meta property="og:url" content="http://localhost:1313/posts/soc-analyst-challenge-day-18/">
  <meta property="og:site_name" content="SecLice">
  <meta property="og:title" content="Day 18: SOC Analyst Challenge ">
  <meta property="og:description" content="SOC Analyst Challenge, Day 18">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-09-12T19:12:51+01:00">
    <meta property="article:modified_time" content="2025-09-12T19:12:51+01:00">
    <meta property="article:tag" content="SOC">
    <meta property="article:tag" content="Cybersecurity">
    <meta property="article:tag" content="SOC Analyst">
    <meta property="article:tag" content="ELK">
    <meta property="article:tag" content="Challenge">




<link rel="canonical" href="http://localhost:1313/posts/soc-analyst-challenge-day-18/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.css" media="screen">






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.css" media="screen">
  



 




<link rel="icon" type="image/svg+xml" href="/images/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="http://localhost:1313/">
      SecLice
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/about/">About</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/posts/">Blog</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/projects/">Projects</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/contact/">Contact me</a>
            </li>
          
        
        
          
          
          
            
          
            
              
                <li class="navigation-item menu-separator">
                  <span>|</span>
                </li>
                
              
              <li class="navigation-item">
                <a href="/pt-br/">ðŸ‡§ðŸ‡·</a>
              </li>
            
          
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="http://localhost:1313/posts/soc-analyst-challenge-day-18/">
              Day 18: SOC Analyst Challenge 
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2025-09-12T19:12:51&#43;01:00">
                September 12, 2025
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              6-minute read
            </span>
          </div>
          <div class="authors">
  <i class="fa-solid fa-user" aria-hidden="true"></i>
    <a href="/authors/seclice/">Seclice</a></div>

          <div class="categories">
  <i class="fa-solid fa-folder" aria-hidden="true"></i>
    <a href="/categories/soc/">SOC</a>
      <span class="separator">â€¢</span>
    <a href="/categories/command-and-control-introduction/">Command and Control Introduction</a></div>

          <div class="tags">
  <i class="fa-solid fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="/tags/soc/">SOC</a>
    </span>
      <span class="separator">â€¢</span>
    <span class="tag">
      <a href="/tags/cybersecurity/">Cybersecurity</a>
    </span>
      <span class="separator">â€¢</span>
    <span class="tag">
      <a href="/tags/soc-analyst/">SOC Analyst</a>
    </span>
      <span class="separator">â€¢</span>
    <span class="tag">
      <a href="/tags/elk/">ELK</a>
    </span>
      <span class="separator">â€¢</span>
    <span class="tag">
      <a href="/tags/challenge/">Challenge</a>
    </span></div>

        </div>
      </header>

      <div class="post-content">
        
        <h2 id="day-15--command-and-control-introduction">
  Day 15:  Command and Control Introduction
  <a class="heading-link" href="#day-15--command-and-control-introduction">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Ressources :<a href="https://www.youtube.com/@MyDFIR/"  class="external-link" target="_blank" rel="noopener">MyDFIR Channel</a></p>
<p>Of course. Here is a clear and structured introduction to Command and Control (C2).</p>
<h3 id="what-is-command-and-control-c2">
  <strong>What is Command and Control (C2)?</strong>
  <a class="heading-link" href="#what-is-command-and-control-c2">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p><strong>Command and Control (C2)</strong>, also known as <strong>C&amp;C</strong> or <strong>C2</strong>, is the infrastructure that cyber attackers use to maintain remote communication and control over compromised devices within a target network.</p>
<p>Think of it as the <strong>secret, malicious version of a remote administration tool</strong> like TeamViewer or RDP. Instead of a legitimate user controlling a machine, it&rsquo;s an attacker.</p>
<h3 id="the-core-purpose-of-c2">
  <strong>The Core Purpose of C2</strong>
  <a class="heading-link" href="#the-core-purpose-of-c2">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>The primary goal of C2 is to establish a covert channel that allows an attacker to:</p>
<ul>
<li><strong>Send commands</strong> to the infected machine (the &ldquo;bot&rdquo; or &ldquo;zombie&rdquo;).</li>
<li><strong>Exfiltrate stolen data</strong> from the victim&rsquo;s network.</li>
<li><strong>Receive the results</strong> of executed commands.</li>
<li><strong>Update the malware</strong> or deploy new tools.</li>
<li><strong>Move laterally</strong> to other systems within the network.</li>
</ul>
<p>Without a C2 channel, malware is just a dumb program. With it, the attacker has hands-on-keyboard control.</p>
<h3 id="how-c2-works-the-lifecycle">
  <strong>How C2 Works: The Lifecycle</strong>
  <a class="heading-link" href="#how-c2-works-the-lifecycle">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>The relationship between the attacker and the compromised host follows a predictable pattern, often called the C2 lifecycle or &ldquo;kill chain.&rdquo;</p>
<div class="mermaid">
flowchart TD
    A[1. Compromise<br>Initial Infection] --> B[2. Establish Foothold<br>Call Home to C2 Server]
    B --> C[3. Beaconing<br>Await Instructions]
    C --> D[4. Command Execution<br>on Target]
    D --> E[5. Exfiltration<br>Send Data to Attacker]
    E --> C

</div>

<h3 id="common-c2-communication-techniques">
  <strong>Common C2 Communication Techniques</strong>
  <a class="heading-link" href="#common-c2-communication-techniques">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>Attackers use various methods to hide their C2 traffic, making it blend in with normal network activity.</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Technique</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Why It&rsquo;s Used</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>Direct Connection</strong></td>
          <td style="text-align: left">The compromised host connects directly to the attacker&rsquo;s IP address.</td>
          <td style="text-align: left">Simple to set up, but easy to detect and block.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>Domain Generation<br>Algorithms (DGA)</strong></td>
          <td style="text-align: left">Malware generates thousands of random domain names to find the one that resolves to the C2 server.</td>
          <td style="text-align: left">Makes it very hard to block all possible domains.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>Social Media &amp;<br>Cloud Services</strong></td>
          <td style="text-align: left">Uses legitimate services like Twitter, GitHub, or Discord to hide commands and exfiltrate data.</td>
          <td style="text-align: left">Traffic blends in with normal web activity, often bypassing firewalls.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>Protocol Impersonation</strong></td>
          <td style="text-align: left">Hides C2 communications within the protocols of common services (e.g., HTTP, HTTPS, DNS).</td>
          <td style="text-align: left">DNS tunneling is very common because DNS is rarely blocked.</td>
      </tr>
  </tbody>
</table>
<h3 id="why-c2-is-a-critical-security-concept">
  <strong>Why C2 is a Critical Security Concept</strong>
  <a class="heading-link" href="#why-c2-is-a-critical-security-concept">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<ul>
<li><strong>Persistence:</strong> C2 is how attackers maintain long-term access to a environment.</li>
<li><strong>The Source of Truth:</strong> Detecting C2 communication is one of the most reliable indicators of a compromise (IoC). A system might be infected with many different malware strains, but they all eventually &ldquo;phone home.&rdquo;</li>
<li><strong>The Goal of Defense:</strong> A primary goal of security monitoring is to <strong>disrupt the C2 channel</strong>. If you can block the attacker&rsquo;s communication, you significantly reduce their impact.</li>
</ul>
<h3 id="how-to-detect-c2-activity">
  <strong>How to Detect C2 Activity</strong>
  <a class="heading-link" href="#how-to-detect-c2-activity">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>Security teams use logs from proxies, firewalls, and DNS servers to look for signs of C2.</p>
<ul>
<li><strong>Unusual Network Connections:</strong> Connections to known malicious IPs/domains from threat intelligence feeds.</li>
<li><strong>Beaconing:</strong> Regular, timed network requests (e.g., every 5 minutes) from an internal host to an external domain.</li>
<li><strong>Anomalous Data Flows:</strong> Large amounts of data being sent from an internal workstation to an external server (exfiltration).</li>
<li><strong>DNS Tunneling:</strong> Unusually long DNS queries, a high volume of DNS requests from a single host, or requests for strange domain names.</li>
</ul>
<p>Of course. Beyond the basic concept, attackers use structured frameworks to manage their C2 operations. These frameworks provide a standardized, feature-rich platform for conducting attacks.</p>
<h3 id="common-c2-communication-architectures">
  <strong>Common C2 Communication Architectures</strong>
  <a class="heading-link" href="#common-c2-communication-architectures">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>Frameworks implement the techniques we discussed earlier using specific architectural models.</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Model</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Pros &amp; Cons</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>1. Centralized (Client-Server)</strong></td>
          <td style="text-align: left">All bots connect back to a single, central C2 server controlled by the attacker.</td>
          <td style="text-align: left"><strong>Simple to set up, but a single point of failure.</strong> If the server is discovered and taken down, the entire network is lost.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>2. Peer-to-Peer (P2P)</strong></td>
          <td style="text-align: left">Bots communicate directly with each other, relaying commands and data. There is no central server.</td>
          <td style="text-align: left"><strong>Resilient to takedowns.</strong> Harder to disrupt, but more complex to set up and manage.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>3. Random</strong></td>
          <td style="text-align: left">Bots communicate using random algorithms (e.g., DGAs) or at random times.</td>
          <td style="text-align: left"><strong>Extremely stealthy.</strong> Very difficult to detect and block due to its unpredictable nature.</td>
      </tr>
  </tbody>
</table>
<div class="mermaid">
flowchart TD
    subgraph Centralized
        A1[Attacker's C2 Server]
        B1[Bot 1] --> A1
        B2[Bot 2] --> A1
        B3[Bot 3] --> A1
    end

    subgraph PeerToPeer
        A2[Bot 1] <--> B4[Bot 2]
        B4 <--> C1[Bot 3]
        C1 <--> A2
    end

    subgraph Random
        D1[Bot 1] <-.->|Beacons at<br>Random Intervals| D2[Bot 2]
    end

</div>

<h3 id="notable-c2-frameworks">
  <strong>Notable C2 Frameworks</strong>
  <a class="heading-link" href="#notable-c2-frameworks">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>Here are some of the most well-known frameworks, used by both penetration testers (red teams) and malicious actors.</p>
<h4 id="1-metasploit-metasploit-framework">
  <strong>1. Metasploit (Metasploit Framework)</strong>
  <a class="heading-link" href="#1-metasploit-metasploit-framework">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h4>
<ul>
<li><strong>Description:</strong> The most famous penetration testing tool. While it&rsquo;s a full exploit framework, its <strong>Meterpreter</strong> payload is a sophisticated, in-memory C2 agent.</li>
<li><strong>Primary Use:</strong> <strong>Penetration Testing &amp; Security Research.</strong> It&rsquo;s the go-to tool for learning and professional security assessments.</li>
</ul>
<h4 id="2-cobalt-strike">
  <strong>2. Cobalt Strike</strong>
  <a class="heading-link" href="#2-cobalt-strike">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h4>
<ul>
<li><strong>Description:</strong> A commercial, full-featured penetration testing tool. It&rsquo;s infamous for being widely adopted by sophisticated threat actors due to its power and evasiveness.</li>
<li><strong>Key Feature:</strong> <strong>Malleable C2 Profiles</strong> allow operators to make their traffic look like legitimate traffic from Google, Apple, etc., making it very hard to detect.</li>
<li><strong>Primary Use:</strong> <strong>Professional Red Teaming.</strong> (Often stolen and used by advanced attackers).</li>
</ul>
<h4 id="3-empire--powershell-empire">
  <strong>3. Empire &amp; PowerShell Empire</strong>
  <a class="heading-link" href="#3-empire--powershell-empire">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h4>
<ul>
<li><strong>Description:</strong> A pure PowerShell and Python post-exploitation framework. It uses PowerShell agents, making it very effective on Windows systems without dropping files to disk.</li>
<li><strong>Primary Use:</strong> Penetration Testing.</li>
</ul>
<h4 id="4-sliver">
  <strong>4. Sliver</strong>
  <a class="heading-link" href="#4-sliver">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h4>
<ul>
<li><strong>Description:</strong> A newer, open-source C2 framework created by Bishop Fox. It&rsquo;s designed to be a cross-platform alternative to Cobalt Strike.</li>
<li><strong>Primary Use:</strong> Penetration Testing and Red Teaming.</li>
</ul>
<h4 id="5-mythic">
  <strong>5. Mythic</strong>
  <a class="heading-link" href="#5-mythic">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h4>
<ul>
<li><strong>Description:</strong> A highly customizable, API-driven C2 framework. Its unique architecture allows operators to mix and different payload types and communication methods within a single campaign.</li>
<li><strong>Primary Use:</strong> Advanced Penetration Testing &amp; Research.</li>
</ul>
<h3 id="the-defender">
  <strong>The Defender&rsquo;s Perspective: How to Counter C2 Frameworks</strong>
  <a class="heading-link" href="#the-defender">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>Security teams focus on detecting the patterns and behaviors of these frameworks, not just the malware itself.</p>
<ol>
<li>
<p><strong>Network Monitoring:</strong> Use firewalls, proxies, and IDS/IPS to look for:</p>
<ul>
<li>Connections to known-bad IPs/domains (Threat Intelligence Feeds).</li>
<li>Unusual protocol use (e.g., DNS tunneling, HTTPS beaconing to non-standard ports).</li>
<li><strong>JA3/S Hashes:</strong> Fingerprints of specific SSL/TLS implementations that can identify C2 frameworks like Cobalt Strike.</li>
</ul>
</li>
<li>
<p><strong>Endpoint Detection and Response (EDR):</strong> EDR tools are critical for detecting the malicious behavior on the host that results from C2 commands, such as:</p>
<ul>
<li><strong>Living Off the Land Binaries (LOLBins):</strong> Using legitimate system tools (like <code>powershell.exe</code>, <code>certutil.exe</code>) for malicious purposes.</li>
<li><strong>Process Injection:</strong> A common technique used by C2 agents to hide in memory.</li>
</ul>
</li>
<li>
<p><strong>Log Analysis (SIEM):</strong> Correlate data from different sources (DNS, HTTP, EDR) to find anomalies indicative of C2, like periodic beaconing.</p>
</li>
</ol>
<p><strong>In summary, C2 frameworks are the professional-grade toolkits that empower attackers. Understanding their architecture and common examples is crucial for defenders, as the entire goal of defense is to disrupt the C2 lifecycle and evict the attacker from the network.</strong></p>

      </div>


      <footer>
        


        <div id="disqus_thread"></div>
<script>
  window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "yourdiscussshortname" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
    
    document.addEventListener('themeChanged', function (e) { 
        if (document.readyState == 'complete') {
          DISQUS.reset({ reload: true, config: disqus_config });
        }
    });
</script>
        
        
        
        
        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    Â©
    
      2017 -
    
    2025
     SecLice 
    Â·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  
  <script src="https://cdn.jsdelivr.net/npm/mermaid@9.3.0/dist/mermaid.min.js"
    integrity="sha256-QdTG1YTLLTwD3b95jLqFxpQX9uYuJMNAtVZgwKX4oYU=" crossorigin="anonymous"></script>
  <script>
    mermaid.initialize({ startOnLoad: true });
  </script>
  

  
  
  <script src="/js/coder.js"></script>
  

  

  


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>
</html>
